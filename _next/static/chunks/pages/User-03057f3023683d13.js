(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[817],{8259:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/User",function(){return s(5733)}])},5733:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var a=s(4848),r=s(6540),l=s(8869),i=s(6665),o=s(3093);s(4338);var n=s(9196);let d=e=>{let{userData:t,loading:s}=e,[d,c]=(0,r.useState)((null==t?void 0:t.name)||""),[x,h]=(0,r.useState)((null==t?void 0:t.mobile)||""),[u,m]=(0,r.useState)(null),[b,f]=(0,r.useState)(!1),[p,j]=(0,r.useState)(!1),[g,y]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!1),[v,S]=(0,r.useState)([]),[C,E]=(0,r.useState)(""),[_,k]=(0,r.useState)(""),[L,D]=(0,r.useState)(!1),[T,A]=(0,r.useState)(""),I=async()=>{let e=i.I.firestore();try{let t=(await e.collection("certificate").get()).docs.map(e=>({id:e.id,...e.data()}));S(t)}catch(e){console.error("Error fetching data: ",e),o.oR.error("There was an error fetching the data.")}};if((0,r.useEffect)(()=>{I()},[]),s)return(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)("div",{className:"spinner-border animate-spin inline-block w-16 h-16 border-4 rounded-full border-t-blue-500 border-gray-200"})});let P=v&&Array.isArray(v)?v.filter(e=>{var t;return null===(t=e.lotno)||void 0===t?void 0:t.toLowerCase().includes(T.toLowerCase())}):[];return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"w-full bg-gradient-to-r from-blue-50 to-blue-100 p-8  shadow-xl",children:[(0,a.jsxs)("h1",{className:"md:text-4xl text-xl font-semibold text-center text-blue-600 mb-6",children:["Welcome, ",null==t?void 0:t.name]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 ease-in-out",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-700",children:"Name:"}),(0,a.jsx)("span",{className:"text-gray-900",children:null==t?void 0:t.name})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 ease-in-out",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-700",children:"Email:"}),(0,a.jsx)("span",{className:"text-gray-900",children:null==t?void 0:t.email})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 ease-in-out",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-700",children:"Mobile Number:"}),(0,a.jsx)("span",{className:"text-gray-900",children:null==t?void 0:t.mobile})]}),(0,a.jsxs)("button",{onClick:()=>{y(!0)},className:"text-blue-500 flex gap-4 font-bold hover:text-blue-700",children:[(0,a.jsx)(l.SG1,{className:"mt-1"})," Edit Profile"]})]})]}),(0,a.jsx)("div",{className:"min-h-screen bg-white flex px-4",children:(0,a.jsxs)("div",{className:"w-full bg-white rounded-lg shadow-lg p-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-semibold text-center text-teal-600 mb-6",children:"Search & Download Certificate Data"}),(0,a.jsx)("input",{type:"text",placeholder:"Search by Lot No.",value:T,onChange:e=>A(e.target.value),className:"mb-4 p-2 border rounded w-full"}),(0,a.jsx)(o.N9,{}),P&&P.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full table-auto border-collapse bg-white",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left text-sm font-bold text-gray-700 border-b",children:"Certificate Title"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-sm font-bold text-gray-700 border-b",children:"Material Code"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-sm font-bold text-gray-700 border-b",children:"Expiry Date"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-sm font-bold text-gray-700 border-b",children:"Lot Number"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-sm font-bold text-gray-700 border-b",children:"Verification Status"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left text-sm font-bold text-gray-700 border-b",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:P.map((e,t)=>(0,a.jsxs)("tr",{className:"hover:bg-teal-50",children:[(0,a.jsxs)("td",{className:"px-4 py-2 text-sm text-gray-600 border-b uppercase",children:[t+1,".",e.certificateTitle]}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-600 border-b uppercase",children:e.materialCode}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-600 border-b uppercase",children:e.expiryDate}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-600 border-b uppercase",children:e.lotno}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-600 border-b uppercase",children:"True"===e.Verified?(0,a.jsx)("span",{className:"text-green-600 font-semibold",children:"Verified"}):(0,a.jsx)("span",{className:"text-red-600 font-semibold",children:"Pending"})}),(0,a.jsx)("td",{className:"px-4 py-2 text-sm text-gray-600 border-b uppercase",children:(0,a.jsx)("button",{onClick:()=>{m(e),f(!0)},className:"text-teal-600 uppercase hover:text-teal-800",children:"View PDF"})})]},t))})]})}):(0,a.jsx)("p",{className:"mt-4 text-center text-gray-600",children:"No matching certificates found"})]})}),b&&(0,a.jsx)("div",{className:"fixed inset-0 flex justify-center items-center bg-gray-800 bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-xl w-full max-w-2xl",children:[(0,a.jsx)(l.yGN,{className:"absolute top-4 right-4 text-gray-600 cursor-pointer",onClick:()=>f(!1)}),(0,a.jsx)(n.A,{fileUrl:null==u?void 0:u.pdfURL})]})})]})};var c=s(7037),x=s(6715);let h=()=>{let[e,t]=(0,r.useState)("home"),[s,l]=(0,r.useState)(null),[o,n]=(0,r.useState)(!0),h=(0,x.useRouter)();(0,r.useEffect)(()=>{let e=i.I.auth().onAuthStateChanged(async e=>{if(e)try{let t=i.I.firestore().collection("users").doc(e.uid),s=await t.get();s.exists?l(s.data()):console.log("No such user!")}catch(e){console.error("Error fetching user data:",e)}finally{n(!1)}else n(!1),h.push("/")});return()=>e()},[h]);let u=async()=>{try{localStorage.removeItem("userRole"),await i.I.auth().signOut(),h.push("/")}catch(e){console.error("Logout failed:",e)}};return o?(0,a.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,a.jsx)("div",{className:"spinner-border animate-spin inline-block w-16 h-16 border-4 rounded-full border-t-blue-500 border-gray-200"})}):(0,a.jsxs)("div",{className:"flex flex-col h-screen justify-between",children:[(0,a.jsx)("div",{children:"home"===e&&(0,a.jsx)(d,{userData:s,loading:o})}),(0,a.jsxs)("div",{className:"fixed bottom-0 left-0 w-full bg-white shadow-lg border-t flex justify-around py-3",children:[(0,a.jsxs)("button",{className:"flex flex-col items-center text-sm ".concat("home"===e?"text-blue-500":"text-gray-600"),onClick:()=>t("home"),children:[(0,a.jsx)(c.rQ8,{size:24}),"Home"]}),(0,a.jsxs)("button",{className:"flex flex-col items-center text-sm text-red-500",onClick:u,children:[(0,a.jsx)(c.axc,{size:24}),"Logout"]})]})]})}},4338:()=>{},6715:(e,t,s)=>{e.exports=s(8440)}},e=>{var t=t=>e(e.s=t);e.O(0,[883,951,864,673,465,563,301,93,264,714,636,593,792],()=>t(8259)),_N_E=e.O()}]);